var Transport=(function(){var c=0,e={},a=6,d=new LruCache(10);function h(i){i=i||{};this.cancelled=false;this.lastUrl=null;this._send=i.transport?f(i.transport):$.ajax;this._get=i.rateLimiter?i.rateLimiter(this._get):this._get;this._cache=i.cache===false?new LruCache(0):d}h.setMaxPendingRequests=function b(i){a=i};h.resetCache=function g(){d.reset()};_.mixin(h.prototype,{_get:function(m,q,j){var p=this,n;if(this.cancelled||m!==this.lastUrl){return}if(n=e[m]){n.done(l).fail(k)}else{if(c<a){c++;e[m]=this._send(m,q).done(l).fail(k).always(i)}else{this.onDeckRequestArgs=[].slice.call(arguments,0)}}function l(o){j&&j(null,o);p._cache.set(m,o)}function k(){j&&j(true)}function i(){c--;delete e[m];if(p.onDeckRequestArgs){p._get.apply(p,p.onDeckRequestArgs);p.onDeckRequestArgs=null}}},get:function(j,l,i){var k;if(_.isFunction(l)){i=l;l={}}this.cancelled=false;this.lastUrl=j;if(k=this._cache.get(j)){_.defer(function(){i&&i(null,k)})}else{this._get(j,l,i)}return !!k},cancel:function(){this.cancelled=true}});return h;function f(i){return function j(l,p){var k=$.Deferred();i(l,p,n,m);return k;function n(o){_.defer(function(){k.resolve(o)})}function m(o){_.defer(function(){k.reject(o)})}}}})();