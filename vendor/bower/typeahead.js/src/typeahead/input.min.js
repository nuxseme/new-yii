var Input=(function(){var w;w={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};function t(F){var D=this,E,A,C,B;F=F||{};if(!F.input){$.error("input is missing")}E=_.bind(this._onBlur,this);A=_.bind(this._onFocus,this);C=_.bind(this._onKeydown,this);B=_.bind(this._onInput,this);this.$hint=$(F.hint);this.$input=$(F.input).on("blur.tt",E).on("focus.tt",A).on("keydown.tt",C);if(this.$hint.length===0){this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=_.noop}if(!_.isMsie()){this.$input.on("input.tt",B)}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(G){if(w[G.which||G.keyCode]){return}_.defer(_.bind(D._onInput,D,G))})}this.query=this.$input.val();this.$overflowHelper=m(this.$input)}t.normalizeQuery=function(A){return(A||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")};_.mixin(t.prototype,EventEmitter,{_onBlur:function k(){this.resetInputValue();this.trigger("blurred")},_onFocus:function e(){this.trigger("focused")},_onKeydown:function y(A){var B=w[A.which||A.keyCode];this._managePreventDefault(B,A);if(B&&this._shouldTrigger(B,A)){this.trigger(B+"Keyed",A)}},_onInput:function b(){this._checkInputValue()},_managePreventDefault:function g(E,D){var C,B,A;switch(E){case"tab":B=this.getHint();A=this.getInputValue();C=B&&B!==A&&!n(D);break;case"up":case"down":C=!n(D);break;default:C=false}C&&D.preventDefault()},_shouldTrigger:function z(C,B){var A;switch(C){case"tab":A=!n(B);break;default:A=true}return A},_checkInputValue:function h(){var A,B,C;A=this.getInputValue();B=j(A,this.query);C=B?this.query.length!==A.length:false;this.query=A;if(!B){this.trigger("queryChanged",this.query)}else{if(C){this.trigger("whitespaceChanged",this.query)}}},focus:function p(){this.$input.focus()},blur:function u(){this.$input.blur()},getQuery:function r(){return this.query},setQuery:function q(A){this.query=A},getInputValue:function f(){return this.$input.val()},setInputValue:function i(B,A){this.$input.val(B);A?this.clearHint():this._checkInputValue()},resetInputValue:function d(){this.setInputValue(this.query,true)},getHint:function c(){return this.$hint.val()},setHint:function v(A){this.$hint.val(A)},clearHint:function l(){this.setHint("")},clearHintIfInvalid:function a(){var D,C,A,B;D=this.getInputValue();C=this.getHint();A=D!==C&&C.indexOf(D)===0;B=D!==""&&A&&!this.hasOverflow();!B&&this.clearHint()},getLanguageDirection:function o(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function s(){var A=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=A},isCursorAtEnd:function(){var B,C,A;B=this.$input.val().length;C=this.$input[0].selectionStart;if(_.isNumber(C)){return C===B}else{if(document.selection){A=document.selection.createRange();A.moveStart("character",-B);return B===A.text.length}}return true},destroy:function x(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null}});return t;function m(A){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:A.css("font-family"),fontSize:A.css("font-size"),fontStyle:A.css("font-style"),fontVariant:A.css("font-variant"),fontWeight:A.css("font-weight"),wordSpacing:A.css("word-spacing"),letterSpacing:A.css("letter-spacing"),textIndent:A.css("text-indent"),textRendering:A.css("text-rendering"),textTransform:A.css("text-transform")}).insertAfter(A)}function j(B,A){return t.normalizeQuery(B)===t.normalizeQuery(A)}function n(A){return A.altKey||A.ctrlKey||A.metaKey||A.shiftKey}})();